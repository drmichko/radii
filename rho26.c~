#include <stdlib.h>
#include <stdio.h>
 #include <unistd.h>
#include <math.h>
#include <assert.h>
#include <ctype.h>
#include "boole.h"
#include "code.h"

int  verb  = 0;
int  target = 1;
FILE * src  = NULL;

void rho26( int seuil )
{
  ffdimen = 6;
  ffsize  = 64;
  char ligne[1024];

  int res;
  code c = RM(2, ffdimen);


  while(fgets(ligne,1024,src)){
	boole f = strToBoole(  ligne );
	res = estimation(f , c, target  );

    if (res){
      panfnum( res, f);
    }



  }

  freeCode(c);
}

int main(int argc, char * argv[]) {

int opt;

 while ((opt = getopt(argc, argv, "t:o:v")) != -1) {
	switch (opt) {
	case 't':
	    target = atoi( optarg );
	    break;
	case 'v':
	    verb++;
	    break;
	default:		/* '?' */
	    fprintf(stderr, "check usage of %s !!!\n",
		    argv[0]);
	    exit(EXIT_FAILURE);
	}
    }
  

  if ( argc == optind )
  	src = fopen("./class-3-6.txt", "r");
  else src = fopen( argv[optind], "r");

  if (! src ) {
          perror("filename");
          exit(1);
  }

  printf("#class NL_2 >= %d :",  target );

  rho26(  target );
  putchar('\n');
  return 0;
}
